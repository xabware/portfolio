import{b as D,u as L,a as R,j as e}from"./index-DlKWlFVv.js";import{r as a,g as d,h as k,i as I,U as T,j as W}from"./lucide-CLwOQzHT.js";import"./react-vendor-Dh3zDKDA.js";const P=a.memo(()=>{const{isLoading:w,isInitialized:n,error:u,sendMessage:j,initProgress:E,initialize:g,hasStarted:S,setHasStarted:b,messages:l,addMessage:i,isLoadingResponse:r,setIsLoadingResponse:h}=D(),{language:y}=L(),t=R(y),[o,p]=a.useState(""),N=a.useRef(null),f=a.useRef(!1),v=a.useCallback(()=>{N.current?.scrollIntoView({behavior:"smooth"})},[]);a.useEffect(()=>{v()},[l,v]),a.useEffect(()=>{if(n&&l.length===0&&!f.current){f.current=!0;const s={id:"welcome-1",text:t.chatbotWelcomeMessage,sender:"bot",timestamp:new Date};i(s)}},[n,l.length,t.chatbotWelcomeMessage,i]);const M=a.useCallback(async()=>{b(!0),await g()},[g,b]),m=a.useCallback(async()=>{if(!o.trim()||r||!n)return;const s={id:Date.now().toString(),text:o,sender:"user",timestamp:new Date};i(s);const C=o;p(""),h(!0);try{const c=await j(C),x={id:(Date.now()+1).toString(),text:c,sender:"bot",timestamp:new Date};i(x)}catch(c){console.error("Error en el chat:",c);const x={id:(Date.now()+1).toString(),text:c instanceof Error?c.message:t.chatbotErrorMessage,sender:"bot",timestamp:new Date};i(x)}finally{h(!1)}},[o,r,n,j,t.chatbotErrorMessage,i,h]),z=a.useCallback(s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),m())},[m]);return S?w||!n?e.jsx("div",{className:"chatbot-container",children:e.jsxs("div",{className:"chatbot-loading",children:[e.jsx(d,{size:48}),e.jsx("h3",{children:t.chatbotLoadingTitle}),e.jsx("p",{children:E}),e.jsx("div",{className:"loading-spinner"}),e.jsx("small",{children:t.chatbotLoadingNote})]})}):u?e.jsx("div",{className:"chatbot-container",children:e.jsxs("div",{className:"chatbot-error",children:[e.jsx(I,{size:48}),e.jsx("h3",{children:t.chatbotErrorTitle}),e.jsx("p",{children:u}),e.jsx("small",{children:t.chatbotErrorNote})]})}):e.jsxs("div",{className:"chatbot-container",children:[e.jsxs("div",{className:"chatbot-messages",children:[l.map(s=>e.jsxs("div",{className:`message ${s.sender}`,children:[e.jsx("div",{className:"message-icon",children:s.sender==="bot"?e.jsx(d,{size:20}):e.jsx(T,{size:20})}),e.jsxs("div",{className:"message-content",children:[e.jsx("p",{children:s.text}),e.jsx("span",{className:"message-time",children:s.timestamp.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]},s.id)),r&&e.jsxs("div",{className:"message bot",children:[e.jsx("div",{className:"message-icon",children:e.jsx(d,{size:20})}),e.jsx("div",{className:"message-content",children:e.jsxs("div",{className:"typing-indicator",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})})]}),e.jsx("div",{ref:N})]}),e.jsxs("div",{className:"chatbot-input",children:[e.jsx("input",{type:"text",placeholder:t.chatbotInputPlaceholder,value:o,onChange:s=>p(s.target.value),onKeyPress:z,disabled:r||!n}),e.jsx("button",{onClick:m,disabled:r||!o.trim()||!n,children:e.jsx(W,{size:20})})]})]}):e.jsx("div",{className:"chatbot-container",children:e.jsxs("div",{className:"chatbot-welcome",children:[e.jsx("div",{className:"welcome-icon",children:e.jsx(d,{size:48})}),e.jsx("h3",{children:t.chatbotWelcomeTitle}),e.jsx("p",{className:"welcome-description",children:t.chatbotWelcomeDescription}),e.jsxs("button",{className:"start-chat-button",onClick:M,children:[e.jsx(k,{size:18}),t.chatbotStartButton]}),e.jsx("small",{className:"welcome-note",children:t.chatbotDownloadNote}),e.jsx("small",{className:"welcome-note",style:{color:"var(--warning-color, #ff9800)",marginTop:"0.5rem"},children:t.chatbotResourceWarning})]})})});P.displayName="Chatbot";export{P as default};
