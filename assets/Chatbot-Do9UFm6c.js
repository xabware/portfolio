import{r as e,j as s,h as t,i as a,k as i,U as n,l as c}from"./react-vendor-ORRQschO.js";import{useWebLLM as o}from"./WebLLMContext-Bw_oFAYE.js";import{u as r,a as l}from"./section-About-BG_NnAdt.js";import"./vendor-nLDBUfSY.js";import"./webllm-CA5sf8U-.js";/* empty css                          */const d=e.memo(()=>{const{isLoading:d,isInitialized:m,error:h,sendMessage:j,initProgress:x,initialize:b,hasStarted:g,setHasStarted:p,messages:u,addMessage:N,isLoadingResponse:v,setIsLoadingResponse:f}=o(),{language:w}=r(),y=l(w),[z,D]=e.useState(""),E=e.useRef(null),C=e.useRef(!1),S=e.useCallback(()=>{E.current?.scrollIntoView({behavior:"smooth"})},[]);e.useEffect(()=>{S()},[u,S]),e.useEffect(()=>{if(m&&0===u.length&&!C.current){C.current=!0;const e={id:"welcome-1",text:y.chatbotWelcomeMessage,sender:"bot",timestamp:new Date};N(e)}},[m,u.length,y.chatbotWelcomeMessage,N]);const k=e.useCallback(async()=>{p(!0),await b()},[b,p]),L=e.useCallback(async()=>{if(!z.trim()||v||!m)return;const e={id:Date.now().toString(),text:z,sender:"user",timestamp:new Date};N(e);const s=z;D(""),f(!0);try{const e=await j(s),t={id:(Date.now()+1).toString(),text:e,sender:"bot",timestamp:new Date};N(t)}catch(t){console.error("Error en el chat:",t);const e={id:(Date.now()+1).toString(),text:t instanceof Error?t.message:y.chatbotErrorMessage,sender:"bot",timestamp:new Date};N(e)}finally{f(!1)}},[z,v,m,j,y.chatbotErrorMessage,N,f]),M=e.useCallback(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),L())},[L]);return g?d||!m?s.jsx("div",{className:"chatbot-container",children:s.jsxs("div",{className:"chatbot-loading",children:[s.jsx(t,{size:48}),s.jsx("h3",{children:y.chatbotLoadingTitle}),s.jsx("p",{children:x}),s.jsx("div",{className:"loading-spinner"}),s.jsx("small",{children:y.chatbotLoadingNote})]})}):h?s.jsx("div",{className:"chatbot-container",children:s.jsxs("div",{className:"chatbot-error",children:[s.jsx(i,{size:48}),s.jsx("h3",{children:y.chatbotErrorTitle}),s.jsx("p",{children:h}),s.jsx("small",{children:y.chatbotErrorNote})]})}):s.jsxs("div",{className:"chatbot-container",children:[s.jsxs("div",{className:"chatbot-messages",children:[u.map(e=>s.jsxs("div",{className:`message ${e.sender}`,children:[s.jsx("div",{className:"message-icon",children:"bot"===e.sender?s.jsx(t,{size:20}):s.jsx(n,{size:20})}),s.jsxs("div",{className:"message-content",children:[s.jsx("p",{children:e.text}),s.jsx("span",{className:"message-time",children:e.timestamp.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]},e.id)),v&&s.jsxs("div",{className:"message bot",children:[s.jsx("div",{className:"message-icon",children:s.jsx(t,{size:20})}),s.jsx("div",{className:"message-content",children:s.jsxs("div",{className:"typing-indicator",children:[s.jsx("span",{}),s.jsx("span",{}),s.jsx("span",{})]})})]}),s.jsx("div",{ref:E})]}),s.jsxs("div",{className:"chatbot-input",children:[s.jsx("input",{type:"text",placeholder:y.chatbotInputPlaceholder,value:z,onChange:e=>D(e.target.value),onKeyPress:M,disabled:v||!m}),s.jsx("button",{onClick:L,disabled:v||!z.trim()||!m,children:s.jsx(c,{size:20})})]})]}):s.jsx("div",{className:"chatbot-container",children:s.jsxs("div",{className:"chatbot-welcome",children:[s.jsx("div",{className:"welcome-icon",children:s.jsx(t,{size:48})}),s.jsx("h3",{children:y.chatbotWelcomeTitle}),s.jsx("p",{className:"welcome-description",children:y.chatbotWelcomeDescription}),s.jsxs("button",{className:"start-chat-button",onClick:k,children:[s.jsx(a,{size:18}),y.chatbotStartButton]}),s.jsx("small",{className:"welcome-note",children:y.chatbotDownloadNote}),s.jsx("small",{className:"welcome-note",style:{color:"var(--warning-color, #ff9800)",marginTop:"0.5rem"},children:y.chatbotResourceWarning})]})})});d.displayName="Chatbot";export{d as default};
